import{q as de,d as o,A as ue,H as ce,e as a,a as e,n as d,f as c,F as L,i as S,t as r,h as M,L as P,o as s}from"./app-DZXOPLfm.js";import{C as g,r as ve}from"./chart-Zj-L_LRF.js";const pe={class:"flex items-center justify-between mb-4"},ye={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},xe={class:"relative h-[160px]"},ge={key:0,class:"absolute inset-0 flex items-center justify-center text-xs"},be={key:1,class:"absolute inset-0 flex items-center justify-center text-[11px] md:text-xs text-gray-400"},me={key:0,class:"mt-2 text-[11px] md:text-xs flex flex-wrap gap-2"},fe={class:"ml-auto font-semibold"},_e={class:"relative h-[160px]"},he={key:0,class:"absolute inset-0 flex items-center justify-center text-xs"},Ce={key:1,class:"absolute inset-0 flex items-center justify-center text-[11px] md:text-xs text-gray-400"},ke={class:"relative h-[160px]"},Pe={key:0,class:"absolute inset-0 flex items-center justify-center text-xs"},we={key:1,class:"absolute inset-0 flex items-center justify-center text-[11px] md:text-xs text-gray-400"},je={key:0,class:"mt-2 text-[11px] md:text-xs text-right"},Be={class:"relative h-[160px]"},Ee={key:0,class:"absolute inset-0 flex items-center justify-center text-xs"},Ae={key:1,class:"absolute inset-0 flex items-center justify-center text-[11px] md:text-xs text-gray-400"},Ne={key:0,class:"mt-2 text-[11px] md:text-xs text-right"},Fe={class:"relative h-[160px]"},Me={key:0,class:"absolute inset-0 flex items-center justify-center text-xs"},De={key:1,class:"absolute inset-0 flex items-center justify-center text-[11px] md:text-xs text-gray-400"},Re={key:0,class:"mt-2 text-[11px] md:text-xs space-y-1 max-h-20 overflow-y-auto pr-1"},Ie={class:"truncate"},Te={class:"relative h-[160px]"},Ve={key:0,class:"absolute inset-0 flex items-center justify-center text-xs"},qe={key:1,class:"absolute inset-0 flex items-center justify-center text-[11px] md:text-xs text-gray-400"},Le={key:0,class:"mt-2 text-[11px] md:text-xs max-h-28 overflow-y-auto space-y-2 pr-1"},Se={class:"flex justify-between gap-2"},ze={class:"font-semibold truncate"},He={class:"flex justify-between gap-2"},Ge={class:"mt-1"},Oe={__name:"DashboardEstadisticas",props:{darkMode:{type:Boolean,default:!1}},setup(ee){g.register(...ve);const te=ee,n=de(()=>te.darkMode),z=o(null),H=o(null),G=o(null),J=o(null),K=o(null),O=o(null);let b=null,m=null,f=null,_=null,h=null,C=null;const v=o({labels:[],cantidades:[],porcentajes:[],total:0}),w=o({labels:[],entradas:[],salidas:[]}),k=o({labels:[],montos:[],total_monto:0}),y=o({labels:[],cantidades:[],montos:[],total_cuotas:0,total_monto:0}),j=o({labels:[],dias_restantes:[],detalles:[]}),x=o({labels:[],cuotas_totales:[],precios_totales:[],montos_pagados:[],detalles:[]}),D=o(!1),B=o(!0),Q=o(!1),R=o(!0),I=o(!1),E=o(!0),T=o(!1),A=o(!0),V=o(!1),N=o(!0),q=o(!1),F=o(!0),i=()=>n.value?"#E5E7EB":"#111827";function U(){if(z.value){if(!v.value.labels.length||v.value.cantidades.every(t=>t===0)){B.value=!1,b&&(b.destroy(),b=null);return}B.value=!0,b&&b.destroy(),b=new g(z.value,{type:"doughnut",data:{labels:v.value.labels,datasets:[{data:v.value.cantidades,backgroundColor:["#2563EB","#16A34A","#F97316"]}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{color:i()}}}}})}}function W(){if(H.value){if(!w.value.labels.length){R.value=!1,m&&(m.destroy(),m=null);return}R.value=!0,m&&m.destroy(),m=new g(H.value,{type:"bar",data:{labels:w.value.labels,datasets:[{label:"Entradas",data:w.value.entradas},{label:"Salidas",data:w.value.salidas}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{labels:{color:i()}}},scales:{x:{ticks:{color:i()}},y:{ticks:{color:i()}}}}})}}function X(){if(G.value){if(!k.value.labels.length||k.value.montos.every(t=>t===0)){E.value=!1,f&&(f.destroy(),f=null);return}E.value=!0,f&&f.destroy(),f=new g(G.value,{type:"bar",data:{labels:k.value.labels,datasets:[{label:"Monto pendiente",data:k.value.montos}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{labels:{color:i()}}},scales:{x:{ticks:{color:i()}},y:{ticks:{color:i()}}}}})}}function Y(){if(J.value){if(!y.value.labels.length||y.value.cantidades.every(t=>t===0)){A.value=!1,_&&(_.destroy(),_=null);return}A.value=!0,_&&_.destroy(),_=new g(J.value,{type:"bar",data:{labels:y.value.labels,datasets:[{label:"Nº de cuotas",data:y.value.cantidades},{label:"Monto total (Bs)",data:y.value.montos}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{labels:{color:i()}}},scales:{x:{ticks:{color:i()}},y:{ticks:{color:i()}}}}})}}function Z(){if(K.value){if(!j.value.labels.length){N.value=!1,h&&(h.destroy(),h=null);return}N.value=!0,h&&h.destroy(),h=new g(K.value,{type:"bar",data:{labels:j.value.labels,datasets:[{label:"Días restantes",data:j.value.dias_restantes}]},options:{indexAxis:"y",responsive:!0,maintainAspectRatio:!1,plugins:{legend:{labels:{color:i()}}},scales:{x:{ticks:{color:i()}},y:{ticks:{color:i()}}}}})}}function $(){if(O.value){if(!x.value.labels.length||x.value.precios_totales.every(t=>t===0)&&x.value.montos_pagados.every(t=>t===0)){F.value=!1,C&&(C.destroy(),C=null);return}F.value=!0,C&&C.destroy(),C=new g(O.value,{type:"bar",data:{labels:x.value.labels,datasets:[{label:"Precio total (Bs)",data:x.value.precios_totales},{label:"Monto pagado (Bs)",data:x.value.montos_pagados}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{labels:{color:i()}}},scales:{x:{ticks:{color:i()}},y:{ticks:{color:i()}}}}})}}async function ae(){D.value=!0;try{const{data:t}=await P.get("propietario/Construccion/dashboard/resumen-personas");v.value=t,U()}catch(t){console.error("Error cargando resumen personas",t),B.value=!1}finally{D.value=!1}}async function se(){Q.value=!0;try{const{data:t}=await P.get("propietario/Construccion/dashboard/inventario-mensual");w.value={labels:t.labels||[],entradas:t.entradas||[],salidas:t.salidas||[]},W()}catch(t){console.error("Error cargando inventario mensual",t),R.value=!1}finally{Q.value=!1}}async function oe(){I.value=!0;try{const{data:t}=await P.get("propietario/Construccion/dashboard/pagos-pendientes");k.value={labels:t.labels||[],montos:t.montos||[],total_monto:t.total_monto||0},X()}catch(t){console.error("Error cargando pagos pendientes",t),E.value=!1}finally{I.value=!1}}async function le(){T.value=!0;try{const{data:t}=await P.get("propietario/Construccion/dashboard/cuotas-pendientes");y.value={labels:t.labels||[],cantidades:t.cantidades||[],montos:t.montos||[],total_cuotas:t.total_cuotas||0,total_monto:t.total_monto||0},Y()}catch(t){console.error("Error cargando cuotas pendientes",t),A.value=!1}finally{T.value=!1}}async function re(){V.value=!0;try{const{data:t}=await P.get("propietario/Construccion/dashboard/proyectos-contador");j.value={labels:t.labels||[],dias_restantes:t.dias_restantes||[],detalles:t.detalles||[]},Z()}catch(t){console.error("Error cargando proyectos contador",t),N.value=!1}finally{V.value=!1}}async function ne(){q.value=!0;try{const{data:t}=await P.get("propietario/Construccion/dashboard/proyectos-pagos-clientes");x.value={labels:t.labels||[],cuotas_totales:t.cuotas_totales||[],precios_totales:t.precios_totales||[],montos_pagados:t.montos_pagados||[],detalles:t.detalles||[]},$()}catch(t){console.error("Error cargando pagos de proyectos",t),F.value=!1}finally{q.value=!1}}function ie(){U(),W(),X(),Y(),Z(),$()}return ue(async()=>{await Promise.all([ae(),se(),oe(),le(),re(),ne()])}),ce(()=>n.value,()=>{ie()}),(t,l)=>(s(),a("div",{class:d(["p-6 md:p-8 rounded-2xl shadow-md transition-colors duration-200",n.value?"bg-gray-900 text-gray-100":"bg-white text-gray-900"])},[e("div",pe,[e("div",null,[e("h2",{class:d(["text-xl md:text-2xl font-bold",n.value?"text-blue-400":"text-blue-700"])}," Tablero de Estadísticas ",2),e("p",{class:d(["text-xs md:text-sm",n.value?"text-gray-300":"text-gray-600"])}," Vista rápida de tu negocio de melamina: personas, inventario, pagos, cuotas y proyectos en curso. ",2)])]),e("div",ye,[e("div",{class:d(["rounded-2xl p-3 md:p-4 border relative min-h-[220px]",n.value?"bg-gray-800 border-gray-700":"bg-gray-50 border-gray-200"])},[l[0]||(l[0]=e("h3",{class:"text-sm md:text-base font-semibold mb-2"}," Personas vinculadas al negocio ",-1)),e("p",{class:d(["text-[11px] md:text-xs mb-2",n.value?"text-gray-300":"text-gray-600"])}," Distribución de trabajadores, clientes y proveedores. ",2),e("div",xe,[e("canvas",{ref_key:"personasCanvas",ref:z,class:"w-full h-full"},null,512),D.value?(s(),a("div",ge," Cargando... ")):B.value?c("",!0):(s(),a("div",be," No hay personas registradas para este propietario. "))]),!D.value&&B.value?(s(),a("div",me,[(s(!0),a(L,null,S(v.value.labels,(u,p)=>(s(),a("span",{key:u},[e("strong",null,r(u)+":",1),M(" "+r(v.value.cantidades[p])+" ("+r(v.value.porcentajes[p])+"%) ",1)]))),128)),e("span",fe," Total: "+r(v.value.total),1)])):c("",!0)],2),e("div",{class:d(["rounded-2xl p-3 md:p-4 border relative min-h-[220px]",n.value?"bg-gray-800 border-gray-700":"bg-gray-50 border-gray-200"])},[l[1]||(l[1]=e("h3",{class:"text-sm md:text-base font-semibold mb-2"}," Inventario: entradas y salidas por mes ",-1)),e("p",{class:d(["text-[11px] md:text-xs mb-2",n.value?"text-gray-300":"text-gray-600"])}," Cantidad de materiales que entran y salen del inventario (por año-mes). ",2),e("div",_e,[e("canvas",{ref_key:"inventarioCanvas",ref:H,class:"w-full h-full"},null,512),Q.value?(s(),a("div",he," Cargando... ")):R.value?c("",!0):(s(),a("div",Ce," No hay movimientos de inventario registrados. "))])],2),e("div",{class:d(["rounded-2xl p-3 md:p-4 border relative min-h-[220px]",n.value?"bg-gray-800 border-gray-700":"bg-gray-50 border-gray-200"])},[l[3]||(l[3]=e("h3",{class:"text-sm md:text-base font-semibold mb-2"}," Pagos pendientes ",-1)),e("p",{class:d(["text-[11px] md:text-xs mb-2",n.value?"text-gray-300":"text-gray-600"])}," Monto total pendiente a trabajadores, proveedores y clientes. ",2),e("div",ke,[e("canvas",{ref_key:"pagosCanvas",ref:G,class:"w-full h-full"},null,512),I.value?(s(),a("div",Pe," Cargando... ")):E.value?c("",!0):(s(),a("div",we," No hay pagos pendientes registrados. "))]),!I.value&&E.value?(s(),a("div",je,[l[2]||(l[2]=M(" Total pendiente: ",-1)),e("strong",null,"Bs "+r(k.value.total_monto.toFixed(2)),1)])):c("",!0)],2),e("div",{class:d(["rounded-2xl p-3 md:p-4 border relative min-h-[220px]",n.value?"bg-gray-800 border-gray-700":"bg-gray-50 border-gray-200"])},[l[6]||(l[6]=e("h3",{class:"text-sm md:text-base font-semibold mb-2"}," Cuotas pendientes ",-1)),e("p",{class:d(["text-[11px] md:text-xs mb-2",n.value?"text-gray-300":"text-gray-600"])}," Número de cuotas y monto total pendiente por tipo de destino. ",2),e("div",Be,[e("canvas",{ref_key:"cuotasCanvas",ref:J,class:"w-full h-full"},null,512),T.value?(s(),a("div",Ee," Cargando... ")):A.value?c("",!0):(s(),a("div",Ae," No hay cuotas pendientes registradas. "))]),!T.value&&A.value?(s(),a("div",Ne,[l[4]||(l[4]=M(" Total cuotas: ",-1)),e("strong",null,r(y.value.total_cuotas),1),l[5]||(l[5]=M(" · Monto total: ",-1)),e("strong",null,"Bs "+r(y.value.total_monto.toFixed(2)),1)])):c("",!0)],2),e("div",{class:d(["rounded-2xl p-3 md:p-4 border relative min-h-[220px]",n.value?"bg-gray-800 border-gray-700":"bg-gray-50 border-gray-200"])},[l[7]||(l[7]=e("h3",{class:"text-sm md:text-base font-semibold mb-2"}," Proyectos en cuenta regresiva ",-1)),e("p",{class:d(["text-[11px] md:text-xs mb-2",n.value?"text-gray-300":"text-gray-600"])}," Días restantes para la fecha de fin de cada proyecto. ",2),e("div",Fe,[e("canvas",{ref_key:"proyectosCanvas",ref:K,class:"w-full h-full"},null,512),V.value?(s(),a("div",Me," Cargando... ")):N.value?c("",!0):(s(),a("div",De," No hay proyectos registrados para este propietario. "))]),!V.value&&N.value?(s(),a("div",Re,[(s(!0),a(L,null,S(j.value.detalles,u=>(s(),a("div",{key:u.nombre,class:"flex justify-between gap-2"},[e("span",Ie,r(u.nombre||"Proyecto")+" ("+r(u.estado)+") ",1),e("span",null,r(u.dias_restantes)+" día(s) restantes ",1)]))),128))])):c("",!0)],2),e("div",{class:d(["rounded-2xl p-3 md:p-4 border relative min-h-[260px]",n.value?"bg-gray-800 border-gray-700":"bg-gray-50 border-gray-200"])},[l[9]||(l[9]=e("h3",{class:"text-sm md:text-base font-semibold mb-2"}," Pagos de clientes por proyecto ",-1)),e("p",{class:d(["text-[11px] md:text-xs mb-2",n.value?"text-gray-300":"text-gray-600"])}," Precio total vs monto pagado por cada proyecto (cuotas de clientes). ",2),e("div",Te,[e("canvas",{ref_key:"proyectosPagosCanvas",ref:O,class:"w-full h-full"},null,512),q.value?(s(),a("div",Ve," Cargando... ")):F.value?c("",!0):(s(),a("div",qe," No hay proyectos con cuotas registradas. "))]),!q.value&&F.value?(s(),a("div",Le,[(s(!0),a(L,null,S(x.value.detalles,u=>(s(),a("div",{key:u.id_proyecto,class:"border-b border-dashed pb-1 last:border-b-0"},[e("div",Se,[e("span",ze,r(u.nombre||"Proyecto #"+u.id_proyecto),1),e("span",null," Cuotas: "+r(u.total_cuotas),1)]),e("div",He,[e("span",null," Precio total: Bs "+r(u.precio_total.toFixed(2)),1),e("span",null," Pagado: Bs "+r(u.monto_pagado.toFixed(2)),1)]),e("div",Ge,[l[8]||(l[8]=e("span",{class:"font-semibold"},"Cuotas:",-1)),(s(!0),a(L,null,S(u.cuotas,p=>(s(),a("span",{key:p.numero_cuota,class:"block"},[M(" #"+r(p.numero_cuota)+" · Bs "+r(p.monto_cuota.toFixed(2))+" · "+r(p.fecha_vencimiento)+" · ",1),e("span",{class:d(p.estado_cuota?"text-green-600":"text-red-600")},r(p.estado_cuota?"Pagada":"Pendiente"),3)]))),128))])]))),128))])):c("",!0)],2)])],2))}};export{Oe as default};
