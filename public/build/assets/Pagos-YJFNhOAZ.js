import{q as v,d as u,e as l,a as e,n as b,f as m,F as Q,i as M,k as q,t as o,o as n,L as B}from"./app-DZXOPLfm.js";const C={class:"overflow-x-auto"},S={class:"w-full text-sm border border-gray-300"},T={class:"p-2 border"},z={class:"p-2 border"},E={class:"p-2 border capitalize"},F={class:"p-2 border"},L={class:"p-2 border"},P={class:"p-2 border"},U={key:0},D={class:"grid grid-cols-1 md:grid-cols-2 gap-6 items-center"},O={class:"flex flex-wrap gap-2"},A={key:0,class:"text-sm mt-1 text-green-500"},N={key:1,class:"text-sm mt-1 text-red-500"},$={class:"flex justify-center"},I={class:"flex flex-col items-center"},V={class:"w-56 h-56 flex items-center justify-center rounded-xl border bg-white overflow-hidden"},G=["src"],W={key:1,class:"text-xs text-gray-500 px-4 text-center"},H={class:"mt-2 text-xs text-gray-400"},K={__name:"Pagos",props:{darkMode:Boolean,trabajador:{type:Object,default:()=>({})},pagosRecibidos:{type:Array,default:()=>[]},qrTrabajador:{type:[String,null],default:null}},setup(s){const y="https://www.tecnoweb.org.bo/inf513/grupo06cc/metaluv-camiri/public/".replace(/\/$/,""),h=a=>a?a.startsWith("http")?a:`${y.replace("/public","")}/storage/app/public/${a}`:null,f=s,_=a=>Number(a||0).toLocaleString("es-BO",{style:"currency",currency:"BOB"}),w=v(()=>f.qrTrabajador?h(f.qrTrabajador):null),g=u(null),x=v(()=>g.value||w.value),d=u(null),p=u(null),i=u(""),c=u("");function j(a){i.value="",c.value="";const t=a.target.files[0]||null;d.value=t,d.value?g.value=URL.createObjectURL(d.value):g.value=null}async function k(){if(i.value="",c.value="",!d.value){c.value="Selecciona una imagen primero.";return}const a=new FormData;a.append("qr",d.value);try{const t=await B.post("trabajador/qr-actualizar",a,{headers:{"Content-Type":"multipart/form-data"}});i.value=t.data.message||"QR actualizado correctamente.",c.value="",d.value=null,p.value&&(p.value.value=""),g.value=null,window.location.reload()}catch(t){console.error(t),c.value=t.response?.data?.message||"Error al subir el QR."}}return(a,t)=>(n(),l("section",{class:b(["rounded-2xl shadow p-6 space-y-6",s.darkMode?"bg-gray-800 text-gray-100":"bg-white text-gray-800"])},[t[3]||(t[3]=e("h3",{class:"text-xl font-bold text-blue-500 mb-2"},"Pagos recibidos",-1)),e("div",C,[e("table",S,[e("thead",{class:b(s.darkMode?"bg-gray-700":"bg-gray-100")},[...t[0]||(t[0]=[e("tr",null,[e("th",{class:"p-2 border"},"Fecha"),e("th",{class:"p-2 border"},"Monto"),e("th",{class:"p-2 border"},"Método"),e("th",{class:"p-2 border"},"Tipo"),e("th",{class:"p-2 border"},"Concepto"),e("th",{class:"p-2 border"},"Estado")],-1)])],2),e("tbody",null,[(n(!0),l(Q,null,M(s.pagosRecibidos,(r,R)=>(n(),l("tr",{key:R},[e("td",T,o(r.fecha_pago),1),e("td",z,o(_(r.monto_total_pago)),1),e("td",E,o(r.metodo_pago),1),e("td",F,o(r.cuotas_pago&&r.cuotas_pago>0?"En cuotas":"Directo"),1),e("td",L,o(r.concepto_pago),1),e("td",P,[e("span",{class:b(["px-2 py-1 rounded text-xs font-semibold",r.estado_pago?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"])},o(r.estado_pago?"Pagado":"Pendiente"),3)])]))),128)),s.pagosRecibidos.length?m("",!0):(n(),l("tr",U,[...t[1]||(t[1]=[e("td",{colspan:"6",class:"text-center py-3 text-gray-500"}," Aún no se registran pagos a tu nombre. ",-1)])]))])])]),e("div",D,[e("div",null,[t[2]||(t[2]=e("h4",{class:"text-lg font-semibold mb-2"},"Tu QR de pago",-1)),e("p",{class:b(["text-sm mb-2",s.darkMode?"text-gray-300":"text-gray-600"])}," Este código QR se usa cuando el propietario te paga por QR. Puedes actualizarlo si el banco te genera uno nuevo. ",2),e("form",{onSubmit:q(k,["prevent"]),class:"space-y-3"},[e("input",{ref_key:"fileInput",ref:p,type:"file",accept:"image/*",class:"block text-sm",onChange:j},null,544),e("div",O,[e("button",{type:"submit",class:b(["px-4 py-2 rounded-lg text-sm font-semibold text-white",s.darkMode?"bg-blue-600 hover:bg-blue-500":"bg-blue-600 hover:bg-blue-700"])}," Guardar nuevo QR ",2)]),i.value?(n(),l("p",A,o(i.value),1)):m("",!0),c.value?(n(),l("p",N,o(c.value),1)):m("",!0)],32)]),e("div",$,[e("div",I,[e("div",V,[x.value?(n(),l("img",{key:0,src:x.value,alt:"QR trabajador",class:"max-w-full max-h-full object-contain"},null,8,G)):(n(),l("span",W," Aún no tienes un QR registrado. "))]),e("p",H,o(s.trabajador?.nombre_trabajador)+" "+o(s.trabajador?.apellido_trabajador),1)])])])],2))}};export{K as default};
