import{q as f,d as g,e as r,a as e,f as p,n as u,F as _,i as w,k as q,t as a,o as l,h as B,L as C}from"./app-DZXOPLfm.js";const E={class:"overflow-x-auto mb-6"},S={class:"w-full text-sm border border-gray-300"},z={class:"p-2 border"},F={class:"p-2 border"},L={class:"p-2 border capitalize"},U={class:"p-2 border"},D={class:"p-2 border"},N={class:"p-2 border"},O={key:0},T={key:0,class:"mb-6"},$={class:"text-xs space-y-1"},A={class:"mt-4 flex flex-col md:flex-row gap-6 items-center"},V={class:"flex-1"},I={key:0,class:"text-sm mt-1 text-green-500"},G={key:1,class:"text-sm mt-1 text-red-500"},W={class:"flex justify-center flex-1"},H={class:"flex flex-col items-center"},J={class:"w-56 h-56 flex items-center justify-center rounded-xl border bg-white overflow-hidden"},K=["src"],X={key:1,class:"text-xs text-gray-500 px-4 text-center"},Y={class:"mt-2 text-xs text-gray-400"},ee={__name:"Pagos",props:{darkMode:{type:Boolean,default:!1},pagos:{type:Array,default:()=>[]},qrProveedor:{type:[String,null],default:null},proveedor:{type:Object,default:()=>({})}},setup(n){const k="https://www.tecnoweb.org.bo/inf513/grupo06cc/metaluv-camiri/public/".replace(/\/$/,""),R=o=>o?o.startsWith("http")?o:`${k.replace("/public","")}/storage/app/public/${o}`:null,b=n,v=o=>Number(o||0).toLocaleString("es-BO",{style:"currency",currency:"BOB"}),y=f(()=>(b.pagos||[]).filter(o=>o.en_cuotas&&(o.cuotas_pago||0)>0)),P=f(()=>b.qrProveedor?R(b.qrProveedor):null),m=g(null),h=f(()=>m.value||P.value),d=g(null),x=g(null),i=g(""),c=g("");function Q(o){i.value="",c.value="";const t=o.target.files[0];d.value=t||null,d.value?m.value=URL.createObjectURL(d.value):m.value=null}async function M(){if(i.value="",c.value="",!d.value){c.value="Selecciona una imagen primero.";return}const o=new FormData;o.append("qr",d.value);try{const t=await C.post("proveedor/qr-actualizar",o,{headers:{"Content-Type":"multipart/form-data"}});i.value=t.data.message||"QR actualizado correctamente.",c.value="",d.value=null,x.value&&(x.value.value=""),window.location.reload()}catch(t){console.error(t),c.value=t.response?.data?.message||"Error al subir el QR."}}return(o,t)=>(l(),r("section",{class:u(["rounded-2xl shadow p-6 max-w-4xl transition-colors duration-300",n.darkMode?"bg-gray-800 text-gray-100":"bg-white text-gray-800"])},[t[4]||(t[4]=e("h3",{class:"text-xl font-bold text-blue-500 mb-4"},"ðŸ’° Pagos recibidos",-1)),e("div",E,[e("table",S,[e("thead",{class:u(n.darkMode?"bg-gray-700":"bg-gray-100")},[...t[0]||(t[0]=[e("tr",null,[e("th",{class:"p-2 border"},"Fecha"),e("th",{class:"p-2 border"},"Monto"),e("th",{class:"p-2 border"},"MÃ©todo"),e("th",{class:"p-2 border"},"Tipo"),e("th",{class:"p-2 border"},"Concepto"),e("th",{class:"p-2 border"},"Estado")],-1)])],2),e("tbody",null,[(l(!0),r(_,null,w(n.pagos,(s,j)=>(l(),r("tr",{key:j,class:u(["border-t",n.darkMode?"border-gray-700":"border-gray-200"])},[e("td",z,a(s.fecha_pago),1),e("td",F,a(v(s.monto_total_pago)),1),e("td",L,a(s.metodo_pago||"-"),1),e("td",U,a(s.en_cuotas?`En cuotas (${s.cuotas_pago})`:"Directo"),1),e("td",D,a(s.concepto_pago||"-"),1),e("td",N,[e("span",{class:u(["px-2 py-1 rounded text-xs font-semibold",s.estado_pago?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"])},a(s.estado_pago?"Pagado":"Pendiente"),3)])],2))),128)),n.pagos.length?p("",!0):(l(),r("tr",O,[...t[1]||(t[1]=[e("td",{colspan:"6",class:"text-center py-3 text-gray-500"}," AÃºn no se registran pagos a tu nombre. ",-1)])]))])])]),y.value.length?(l(),r("div",T,[t[2]||(t[2]=e("h4",{class:"font-semibold mb-2 text-sm"},"Pagos con detalle de cuotas",-1)),e("ul",$,[(l(!0),r(_,null,w(y.value,s=>(l(),r("li",{key:s.id_pago},[e("b",null,a(s.concepto_pago||"Pago"),1),B(" Â· "+a(v(s.monto_total_pago))+" Â· "+a(s.cuotas?.length||s.cuotas_pago)+" cuotas ",1)]))),128))])])):p("",!0),e("div",A,[e("div",V,[t[3]||(t[3]=e("h4",{class:"text-lg font-semibold mb-2"},"Tu QR de cobro",-1)),e("p",{class:u(["text-sm mb-3",n.darkMode?"text-gray-300":"text-gray-600"])}," Este cÃ³digo QR se usa cuando el propietario te paga por QR. Puedes actualizarlo si tu banco te genera uno nuevo. ",2),e("form",{onSubmit:q(M,["prevent"]),class:"space-y-3"},[e("input",{ref_key:"fileInput",ref:x,type:"file",accept:"image/*",class:"block text-sm",onChange:Q},null,544),e("button",{type:"submit",class:u(["px-4 py-2 rounded-lg text-sm font-semibold text-white",n.darkMode?"bg-blue-600 hover:bg-blue-500":"bg-blue-600 hover:bg-blue-700"])}," Guardar nuevo QR ",2),i.value?(l(),r("p",I,a(i.value),1)):p("",!0),c.value?(l(),r("p",G,a(c.value),1)):p("",!0)],32)]),e("div",W,[e("div",H,[e("div",J,[h.value?(l(),r("img",{key:0,src:h.value,alt:"QR proveedor",class:"max-w-full max-h-full object-contain"},null,8,K)):(l(),r("span",X," AÃºn no tienes un QR registrado. "))]),e("p",Y,a(n.proveedor?.nombre_empres_prov||"Proveedor"),1)])])])],2))}};export{ee as default};
