import{d as m,A as w,e as d,a as e,n as s,h as i,f as M,F as C,i as V,L as x,m as S,o as n,t as c,l as b,v as E,K as y}from"./app-DZXOPLfm.js";import{_ as U}from"./_plugin-vue_export-helper-DlAUqK2U.js";const A={class:"flex flex-col md:flex-row md:items-center md:justify-between gap-3 mb-4"},z={class:"flex gap-2"},B={key:1},F={class:"px-2 py-2 text-center"},N={class:"px-2 py-2 text-center"},P={class:"px-2 py-2"},T={class:"px-2 py-2 max-w-xs"},D={class:"px-2 py-2 text-right whitespace-nowrap"},I=["onUpdate:modelValue"],$={class:"px-2 py-2"},j=["onUpdate:modelValue"],q={class:"px-2 py-2"},L=["onUpdate:modelValue"],O={class:"px-2 py-2"},Q={class:"flex gap-1 justify-center"},R=["onClick"],G=["onClick"],K={key:0},H={__name:"Compras",props:{darkMode:{type:Boolean,default:!1}},emits:["ver-proyecto"],setup(o,{emit:v}){const h=v,p=m([]),u=m(!1);async function g(){try{u.value=!0;const{data:a}=await x.get("proveedor/compras/pendientes");p.value=a?.compras||[]}catch(a){console.error(a),alert("Error al cargar solicitudes de compra")}finally{u.value=!1}}async function _(a){try{await x.put(`proveedor/compras/${a.id_compra}`,{estado_compra:a.estado_compra,metodo_pago_comp:a.metodo_pago_comp,total_compra:a.total_compra}),alert("Solicitud actualizada correctamente"),await g()}catch(r){console.error(r),alert("Error al actualizar la solicitud")}}function f(a){if(!a.proyecto){alert("Esta compra no tiene proyecto asociado.");return}h("ver-proyecto",a.proyecto)}function k(){S.visit("proveedor/dashboard")}return w(()=>{g()}),(a,r)=>(n(),d("section",{class:s(["rounded-2xl shadow p-6 w-full transition-colors duration-300",o.darkMode?"bg-gray-800 text-gray-100":"bg-white text-gray-800"])},[e("div",A,[e("div",null,[r[1]||(r[1]=e("h1",{class:"text-2xl font-bold text-blue-600"}," ðŸ§¾ Solicitudes de compra ",-1)),e("p",{class:s(["text-sm",o.darkMode?"text-gray-300":"text-gray-600"])},[...r[0]||(r[0]=[i(" AquÃ­ se muestran las compras ",-1),e("b",null,"pendientes",-1),i(" que el propietario registrÃ³ a tu nombre. Solo puedes modificar el ",-1),e("b",null,"estado",-1),i(", el ",-1),e("b",null,"mÃ©todo de pago",-1),i(" y el ",-1),e("b",null,"total",-1),i(". ",-1)])],2)]),e("div",z,[e("button",{class:s(["px-3 py-2 rounded-lg text-sm font-semibold",o.darkMode?"bg-gray-700 hover:bg-gray-600":"bg-gray-200 hover:bg-gray-300"]),onClick:k}," â¬… Volver al panel ",2),e("button",{class:s(["px-3 py-2 rounded-lg text-sm font-semibold text-white",o.darkMode?"bg-blue-600 hover:bg-blue-500":"bg-blue-600 hover:bg-blue-700"]),onClick:g}," ðŸ”„ Actualizar ",2)])]),u.value?(n(),d("div",{key:0,class:s(["text-sm",o.darkMode?"text-gray-300":"text-gray-500"])}," Cargando solicitudes... ",2)):(n(),d("div",B,[e("table",{class:s(["w-full text-sm border rounded-lg overflow-hidden",o.darkMode?"border-gray-700":"border-gray-200"])},[e("thead",{class:s(o.darkMode?"bg-gray-700 text-gray-100":"bg-blue-600 text-white")},[...r[2]||(r[2]=[e("tr",null,[e("th",{class:"px-2 py-2"},"ID"),e("th",{class:"px-2 py-2"},"Fecha"),e("th",{class:"px-2 py-2"},"Proyecto"),e("th",{class:"px-2 py-2"},"ObservaciÃ³n"),e("th",{class:"px-2 py-2"},"Total"),e("th",{class:"px-2 py-2"},"MÃ©todo de pago"),e("th",{class:"px-2 py-2"},"Estado"),e("th",{class:"px-2 py-2"},"AcciÃ³n")],-1)])],2),e("tbody",null,[(n(!0),d(C,null,V(p.value,t=>(n(),d("tr",{key:t.id_compra,class:s(["align-top",o.darkMode?"border-b border-gray-700 hover:bg-gray-700/40":"border-b border-gray-200 hover:bg-gray-50"])},[e("td",F,c(t.id_compra),1),e("td",N,c(t.fecha_compra),1),e("td",P,c(t.proyecto?t.proyecto.nombre_pro:"Sin proyecto"),1),e("td",T,[e("div",{class:s(["max-h-24 overflow-y-auto text-xs whitespace-pre-line rounded-md px-2 py-1",o.darkMode?"border border-gray-600 bg-gray-900":"border border-gray-200 bg-gray-50"])},c(t.observacion_comp||"Sin observaciÃ³n."),3)]),e("td",D,[b(e("input",{type:"number",step:"0.01","onUpdate:modelValue":l=>t.total_compra=l,class:"input text-right text-xs w-24 inline-block"},null,8,I),[[E,t.total_compra,void 0,{number:!0}]])]),e("td",$,[b(e("select",{"onUpdate:modelValue":l=>t.metodo_pago_comp=l,class:"input text-xs"},[...r[3]||(r[3]=[e("option",{disabled:"",value:""},"Seleccione",-1),e("option",{value:"EFECTIVO"},"Efectivo",-1),e("option",{value:"QR"},"QR",-1)])],8,j),[[y,t.metodo_pago_comp]])]),e("td",q,[b(e("select",{"onUpdate:modelValue":l=>t.estado_compra=l,class:"input text-xs"},[...r[4]||(r[4]=[e("option",{value:"Pendiente"},"Pendiente",-1),e("option",{value:"Completada"},"Completada",-1),e("option",{value:"Anulada"},"Anulada",-1)])],8,L),[[y,t.estado_compra]])]),e("td",O,[e("div",Q,[e("button",{class:s(["px-3 py-1 rounded-lg text-xs font-semibold text-white",o.darkMode?"bg-green-600 hover:bg-green-500":"bg-green-600 hover:bg-green-700"]),onClick:l=>_(t)}," ðŸ’¾ Guardar ",10,R),e("button",{class:s(["px-3 py-1 rounded-lg text-xs font-semibold",o.darkMode?"bg-blue-500 hover:bg-blue-400 text-white":"bg-blue-100 hover:bg-blue-200 text-blue-800"]),onClick:l=>f(t)}," Ver ",10,G)])])],2))),128)),p.value.length?M("",!0):(n(),d("tr",K,[e("td",{colspan:"8",class:s(["px-3 py-4 text-center",o.darkMode?"text-gray-300":"text-gray-500"])}," No tienes compras pendientes por el momento. ",2)]))])],2)]))],2))}},X=U(H,[["__scopeId","data-v-baa02327"]]);export{X as default};
