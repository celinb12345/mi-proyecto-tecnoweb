import{d as s,q as B,H as ue,A as be,L as M,e as r,a as e,f as v,l as g,K as S,n as i,t as d,v as V,F as A,i as $,k as H,h as L,o as n}from"./app-DZXOPLfm.js";import{_ as ce}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ve={class:"grid grid-cols-3 gap-4 mb-6"},ge={class:"flex items-end gap-2"},pe={class:"flex items-end justify-end"},me=["value"],ye=["value"],xe={class:"col-span-2 flex justify-end gap-2"},_e={type:"submit",class:"btn-green"},fe={key:0,class:"overflow-x-auto mb-6"},he={class:"w-full border border-gray-200 rounded-lg text-sm text-center"},ke={class:"px-2 py-2"},we={class:"px-2 py-2"},Me={class:"px-2 py-2"},Ce={class:"px-2 py-2"},Ue={class:"px-2 py-2"},Ee={key:0},Ie={class:"px-2 py-2 space-x-2 text-center"},Se=["onClick"],Ve=["onClick"],Ae=["onClick"],$e={key:0},De={key:0,class:"flex flex-col md:flex-row md:items-center md:justify-between gap-3 mt-3 text-xs md:text-sm"},Ne={class:"flex flex-wrap items-center gap-1"},Te=["disabled"],Le=["onClick"],Pe=["disabled"],ze={key:1,class:"border-t pt-4 mt-4 mb-6"},Be={class:"text-lg font-bold text-blue-500 mb-2"},Fe={key:0,class:"overflow-x-auto"},je={class:"w-full border border-gray-200 rounded-lg text-sm text-center"},Oe={class:"px-2 py-2"},Re={class:"px-2 py-2"},qe={class:"px-2 py-2"},Ge={class:"px-2 py-2"},He={key:2,class:"border-t pt-6 mt-4"},Ke={class:"flex justify-between items-center mb-4"},Je={class:"col-span-2"},Qe={class:"col-span-2 flex justify-end gap-2"},We={type:"submit",class:"btn-indigo"},Xe={key:0,class:"overflow-x-auto"},Ye={class:"w-full border border-gray-200 rounded-lg text-sm text-center"},Ze={class:"px-2 py-2"},et={class:"px-2 py-2"},tt={class:"px-2 py-2"},at={class:"px-2 py-2"},ot={class:"px-2 py-2 space-x-2"},dt=["onClick"],rt=["onClick"],it={key:0},p="rounded-lg p-2 w-full focus:ring-2 focus:ring-blue-400 focus:outline-none transition-colors duration-200",nt={__name:"Inventario",props:{darkMode:{type:Boolean,default:!1},fontClass:{type:String,default:"font-sans"}},setup(K){const l=K,m=s([]),F=s([]),x=s([]),D=s(""),f=s(!1),h=s(!1),P=s(null),b=s({id_inventario:"",tipo_movimiento:"",cantidad_inv:"",fecha_inv:"",id_producto:"",id_unidad:""}),k=s(null),y=s(null),C=s(!1),U=s(!1),w=s(!1),z=s(null),c=s({nombre_unidad:"",abreviatura_unidad:"",descripcion_unidad:"",estado_unidad:!0}),u=s(1),E=s(5),_=B(()=>m.value.length?Math.ceil(m.value.length/E.value):1),J=B(()=>{const o=(u.value-1)*E.value;return m.value.slice(o,o+E.value)}),j=B(()=>{if(!m.value.length)return{from:0,to:0};const o=(u.value-1)*E.value+1,t=Math.min(u.value*E.value,m.value.length);return{from:o,to:t}});ue(m,()=>{u.value>_.value&&(u.value=_.value)});function Q(o){o>=1&&o<=_.value&&(u.value=o)}function W(){u.value>1&&u.value--}function X(){u.value<_.value&&u.value++}function O(o){return o?String(o).split("T")[0]:""}be(()=>{R()});function R(o={}){return M.get("propietario/melamina/inventario",{params:o}).then(t=>{m.value=t.data.inventarios||[],F.value=t.data.productos||[],x.value=t.data.unidades||[],u.value=1}).catch(t=>{console.error("Error al obtener inventario:",t),alert("Error al obtener movimientos de inventario")})}function N(){const o={};D.value&&(o.tipo=D.value),R(o).then(()=>{f.value=!0})}function Y(){f.value=!f.value,f.value&&N()}function Z(){const o={...b.value},t=h.value?`propietario/melamina/inventario/${P.value}`:"propietario/melamina/inventario";M.post(t,o).then(a=>{a.data.success&&(alert(h.value?"Movimiento actualizado":"Movimiento registrado"),q(),N())}).catch(a=>{console.error("Error al guardar inventario:",a),alert("Error al guardar movimiento de inventario")})}function ee(o){h.value=!0,P.value=o.id_inventario,b.value={id_inventario:o.id_inventario,tipo_movimiento:o.tipo_movimiento?"entrada":"salida",cantidad_inv:o.cantidad_inv,fecha_inv:O(o.fecha_inv),id_producto:o.id_producto,id_unidad:o.id_unidad}}function te(o){confirm("Â¿Eliminar este movimiento de inventario?")&&M.delete(`propietario/melamina/inventario/${o}`).then(()=>{alert("Movimiento eliminado"),N(),k.value&&k.value.id_inventario===o&&(k.value=null,y.value=null)}).catch(t=>{console.error("Error al eliminar inventario:",t),alert("Error al eliminar movimiento")})}function q(){h.value=!1,P.value=null,b.value={id_inventario:"",tipo_movimiento:"",cantidad_inv:"",fecha_inv:"",id_producto:"",id_unidad:""}}function ae(){q()}function oe(o){if(k.value=o,!o||!o.id_unidad){y.value=null;return}const t=x.value.find(a=>a.id_unidad===o.id_unidad);y.value=t||null}function de(){C.value=!C.value,C.value&&!x.value.length&&T()}function re(){U.value=!U.value,U.value&&!x.value.length&&T()}function T(o={}){return M.get("propietario/melamina/unidad-medida",{params:o}).then(t=>{x.value=t.data.unidades||[]}).catch(t=>{console.error("Error al obtener unidades:",t),alert("Error al obtener unidades de medida")})}function ie(){const o={...c.value},t=w.value?`propietario/melamina/unidad-medida/${z.value}`:"propietario/melamina/unidad-medida";M.post(t,o).then(a=>{a.data.success&&(alert(w.value?"Unidad actualizada":"Unidad registrada"),G(),T())}).catch(a=>{console.error("Error al guardar unidad:",a),alert("Error al guardar unidad de medida")})}function ne(o){w.value=!0,z.value=o.id_unidad,c.value={nombre_unidad:o.nombre_unidad,abreviatura_unidad:o.abreviatura_unidad,descripcion_unidad:o.descripcion_unidad,estado_unidad:!!o.estado_unidad}}function le(o){confirm("Â¿Eliminar esta unidad de medida?")&&M.delete(`propietario/melamina/unidad-medida/${o}`).then(()=>{alert("Unidad eliminada"),T()}).catch(t=>{console.error("Error al eliminar unidad:",t),alert("Error al eliminar unidad de medida")})}function G(){w.value=!1,z.value=null,c.value={nombre_unidad:"",abreviatura_unidad:"",descripcion_unidad:"",estado_unidad:!0}}function se(){G()}return(o,t)=>(n(),r("div",{class:i(["p-8 rounded-2xl shadow-md transition-colors duration-300",l.darkMode?"bg-gray-800 text-gray-100":"bg-white text-gray-900",l.fontClass])},[t[33]||(t[33]=e("h2",{class:"text-2xl font-bold text-blue-500 mb-6"},"GestiÃ³n de Inventario",-1)),e("div",ve,[e("div",null,[t[11]||(t[11]=e("label",{class:"block text-sm font-semibold mb-1"},"Tipo de movimiento",-1)),g(e("select",{"onUpdate:modelValue":t[0]||(t[0]=a=>D.value=a),class:i([p,l.darkMode?"bg-gray-900 border-gray-600 text-gray-100":"bg-white border-gray-300 text-gray-900"])},[...t[10]||(t[10]=[e("option",{value:""},"Todos",-1),e("option",{value:"entrada"},"Entradas",-1),e("option",{value:"salida"},"Salidas",-1)])],2),[[S,D.value]])]),e("div",ge,[e("button",{onClick:N,class:"btn-blue w-full"},"Buscar"),e("button",{onClick:Y,class:"btn-gray w-full"},d(f.value?"Ocultar lista":"Listar movimientos"),1)]),e("div",pe,[e("button",{onClick:de,class:"btn-indigo"},d(C.value?"Ocultar unidades":"AÃ±adir unidad de medida"),1)])]),e("form",{onSubmit:H(Z,["prevent"]),class:"grid grid-cols-2 gap-4 mb-8"},[e("div",null,[t[12]||(t[12]=e("label",{class:"block text-sm font-semibold mb-1"},"Fecha",-1)),g(e("input",{type:"date","onUpdate:modelValue":t[1]||(t[1]=a=>b.value.fecha_inv=a),class:i([p,l.darkMode?"bg-gray-900 border-gray-600 text-gray-100":"bg-white border-gray-300 text-gray-900"])},null,2),[[V,b.value.fecha_inv]])]),e("div",null,[t[14]||(t[14]=e("label",{class:"block text-sm font-semibold mb-1"},"Tipo de movimiento",-1)),g(e("select",{"onUpdate:modelValue":t[2]||(t[2]=a=>b.value.tipo_movimiento=a),class:i([p,l.darkMode?"bg-gray-900 border-gray-600 text-gray-100":"bg-white border-gray-300 text-gray-900"])},[...t[13]||(t[13]=[e("option",{disabled:"",value:""},"Seleccione",-1),e("option",{value:"entrada"},"Entrada",-1),e("option",{value:"salida"},"Salida",-1)])],2),[[S,b.value.tipo_movimiento]])]),e("div",null,[t[15]||(t[15]=e("label",{class:"block text-sm font-semibold mb-1"},"Cantidad",-1)),g(e("input",{type:"number",step:"0.01","onUpdate:modelValue":t[3]||(t[3]=a=>b.value.cantidad_inv=a),class:i([p,l.darkMode?"bg-gray-900 border-gray-600 text-gray-100":"bg-white border-gray-300 text-gray-900"])},null,2),[[V,b.value.cantidad_inv]])]),e("div",null,[t[17]||(t[17]=e("label",{class:"block text-sm font-semibold mb-1"},"Producto",-1)),g(e("select",{"onUpdate:modelValue":t[4]||(t[4]=a=>b.value.id_producto=a),class:i([p,l.darkMode?"bg-gray-900 border-gray-600 text-gray-100":"bg-white border-gray-300 text-gray-900"])},[t[16]||(t[16]=e("option",{disabled:"",value:""},"Seleccione producto",-1)),(n(!0),r(A,null,$(F.value,a=>(n(),r("option",{key:a.id_producto,value:a.id_producto},d(a.nombre_prod),9,me))),128))],2),[[S,b.value.id_producto]])]),e("div",null,[t[19]||(t[19]=e("label",{class:"block text-sm font-semibold mb-1"},"Unidad de medida",-1)),g(e("select",{"onUpdate:modelValue":t[5]||(t[5]=a=>b.value.id_unidad=a),class:i([p,l.darkMode?"bg-gray-900 border-gray-600 text-gray-100":"bg-white border-gray-300 text-gray-900"])},[t[18]||(t[18]=e("option",{disabled:"",value:""},"Seleccione unidad",-1)),(n(!0),r(A,null,$(x.value,a=>(n(),r("option",{key:a.id_unidad,value:a.id_unidad},d(a.nombre_unidad)+" ("+d(a.abreviatura_unidad)+") ",9,ye))),128))],2),[[S,b.value.id_unidad]])]),e("div",xe,[e("button",_e,d(h.value?"Actualizar":"Registrar"),1),h.value?(n(),r("button",{key:0,type:"button",onClick:ae,class:"btn-gray"}," Cancelar ")):v("",!0)])],32),f.value?(n(),r("div",fe,[e("table",he,[t[20]||(t[20]=e("thead",{class:"bg-blue-600 text-white"},[e("tr",null,[e("th",{class:"px-2 py-2 border border-blue-500/60"},"Fecha"),e("th",{class:"px-2 py-2 border border-blue-500/60"},"Tipo"),e("th",{class:"px-2 py-2 border border-blue-500/60"},"Cantidad"),e("th",{class:"px-2 py-2 border border-blue-500/60"},"Producto"),e("th",{class:"px-2 py-2 border border-blue-500/60"},"Unidad"),e("th",{class:"px-2 py-2 border border-blue-500/60"},"Acciones")])],-1)),e("tbody",null,[(n(!0),r(A,null,$(J.value,a=>(n(),r("tr",{key:a.id_inventario,class:i(l.darkMode?"border-b border-gray-700 hover:bg-gray-700":"border-b hover:bg-gray-50")},[e("td",ke,d(O(a.fecha_inv)),1),e("td",we,[e("span",{class:i(a.tipo_movimiento?"text-green-400 font-semibold":"text-red-400 font-semibold")},d(a.tipo_movimiento?"Entrada":"Salida"),3)]),e("td",Me,d(a.cantidad_inv),1),e("td",Ce,d(a.producto?a.producto.nombre_prod:""),1),e("td",Ue,[a.unidad?(n(),r("span",Ee,d(a.unidad.nombre_unidad)+" ("+d(a.unidad.abreviatura_unidad)+") ",1)):v("",!0)]),e("td",Ie,[e("button",{onClick:I=>ee(a),class:"bg-yellow-500 hover:bg-yellow-600 text-white px-3 py-1 rounded text-xs font-semibold"}," âœï¸ Editar ",8,Se),e("button",{onClick:I=>te(a.id_inventario),class:"bg-red-600 hover:bg-red-700 text-white px-3 py-1 rounded text-xs font-semibold"}," ðŸ—‘ Eliminar ",8,Ve),e("button",{onClick:I=>oe(a),class:"bg-indigo-600 hover:bg-indigo-700 text-white px-3 py-1 rounded text-xs font-semibold"}," ðŸ“„ Detalles ",8,Ae)])],2))),128)),m.value.length?v("",!0):(n(),r("tr",$e,[e("td",{colspan:"6",class:i(["text-center py-3",l.darkMode?"text-gray-300":"text-gray-500"])}," No hay movimientos registrados con el filtro actual ",2)]))])]),_.value>1?(n(),r("div",De,[e("div",null,[t[21]||(t[21]=L(" Mostrando ",-1)),e("b",null,d(j.value.from),1),t[22]||(t[22]=L(" - ",-1)),e("b",null,d(j.value.to),1),t[23]||(t[23]=L(" de ",-1)),e("b",null,d(m.value.length),1),t[24]||(t[24]=L(" movimientos ",-1))]),e("div",Ne,[e("button",{class:i(["px-2 py-1 rounded border",l.darkMode?"bg-gray-800 border-gray-600 text-gray-100":"bg-white border-gray-300 text-gray-700"]),onClick:W,disabled:u.value===1}," â¬… ",10,Te),(n(!0),r(A,null,$(_.value,a=>(n(),r("button",{key:a,class:i(["px-2 py-1 rounded border text-xs",[a===u.value?"bg-blue-600 text-white border-blue-500":l.darkMode?"bg-gray-800 text-gray-100 border-gray-600 hover:bg-gray-700":"bg-white text-gray-700 border-gray-300 hover:bg-gray-100"]]),onClick:I=>Q(a)},d(a),11,Le))),128)),e("button",{class:i(["px-2 py-1 rounded border",l.darkMode?"bg-gray-800 border-gray-600 text-gray-100":"bg-white border-gray-300 text-gray-700"]),onClick:X,disabled:u.value===_.value}," âž¡ ",10,Pe)])])):v("",!0)])):v("",!0),k.value?(n(),r("div",ze,[e("h3",Be," Detalles de unidad de medida del movimiento # "+d(k.value.id_inventario),1),y.value?(n(),r("div",Fe,[e("table",je,[t[25]||(t[25]=e("thead",{class:"bg-indigo-600 text-white"},[e("tr",null,[e("th",{class:"px-2 py-2 border border-indigo-500/60"},"Nombre"),e("th",{class:"px-2 py-2 border border-indigo-500/60"},"Abreviatura"),e("th",{class:"px-2 py-2 border border-indigo-500/60"},"DescripciÃ³n"),e("th",{class:"px-2 py-2 border border-indigo-500/60"},"Estado")])],-1)),e("tbody",null,[e("tr",{class:i(l.darkMode?"border-b border-gray-700":"border-b")},[e("td",Oe,d(y.value.nombre_unidad),1),e("td",Re,d(y.value.abreviatura_unidad),1),e("td",qe,d(y.value.descripcion_unidad),1),e("td",Ge,[e("span",{class:i(y.value.estado_unidad?"text-green-400 font-semibold":"text-red-400 font-semibold")},d(y.value.estado_unidad?"Activo":"Inactivo"),3)])],2)])])])):(n(),r("p",{key:1,class:i(l.darkMode?"text-gray-300":"text-gray-500")}," No se encontrÃ³ informaciÃ³n de la unidad de medida. ",2))])):v("",!0),C.value?(n(),r("div",He,[e("div",Ke,[t[26]||(t[26]=e("h3",{class:"text-xl font-bold text-blue-500"},"Unidades de medida",-1)),e("button",{onClick:re,class:"btn-gray"},d(U.value?"Ocultar lista":"Listar unidades"),1)]),e("form",{onSubmit:H(ie,["prevent"]),class:"grid grid-cols-2 gap-4 mb-6"},[e("div",null,[t[27]||(t[27]=e("label",{class:"block text-sm font-semibold mb-1"},"Nombre unidad",-1)),g(e("input",{"onUpdate:modelValue":t[6]||(t[6]=a=>c.value.nombre_unidad=a),class:i([p,l.darkMode?"bg-gray-900 border-gray-600 text-gray-100":"bg-white border-gray-300 text-gray-900"])},null,2),[[V,c.value.nombre_unidad]])]),e("div",null,[t[28]||(t[28]=e("label",{class:"block text-sm font-semibold mb-1"},"Abreviatura",-1)),g(e("input",{"onUpdate:modelValue":t[7]||(t[7]=a=>c.value.abreviatura_unidad=a),class:i([p,l.darkMode?"bg-gray-900 border-gray-600 text-gray-100":"bg-white border-gray-300 text-gray-900"])},null,2),[[V,c.value.abreviatura_unidad]])]),e("div",Je,[t[29]||(t[29]=e("label",{class:"block text-sm font-semibold mb-1"},"DescripciÃ³n",-1)),g(e("textarea",{"onUpdate:modelValue":t[8]||(t[8]=a=>c.value.descripcion_unidad=a),rows:"2",class:i([p,l.darkMode?"bg-gray-900 border-gray-600 text-gray-100 placeholder-gray-400":"bg-white border-gray-300 text-gray-900 placeholder-gray-400"])},null,2),[[V,c.value.descripcion_unidad]])]),e("div",null,[t[31]||(t[31]=e("label",{class:"block text-sm font-semibold mb-1"},"Estado",-1)),g(e("select",{"onUpdate:modelValue":t[9]||(t[9]=a=>c.value.estado_unidad=a),class:i([p,l.darkMode?"bg-gray-900 border-gray-600 text-gray-100":"bg-white border-gray-300 text-gray-900"])},[...t[30]||(t[30]=[e("option",{value:!0},"Activo",-1),e("option",{value:!1},"Inactivo",-1)])],2),[[S,c.value.estado_unidad]])]),e("div",Qe,[e("button",We,d(w.value?"Actualizar unidad":"Registrar unidad"),1),w.value?(n(),r("button",{key:0,type:"button",onClick:se,class:"btn-gray"}," Cancelar ")):v("",!0)])],32),U.value?(n(),r("div",Xe,[e("table",Ye,[t[32]||(t[32]=e("thead",{class:"bg-gray-700 text-white"},[e("tr",null,[e("th",{class:"px-2 py-2 border border-gray-600"},"Nombre"),e("th",{class:"px-2 py-2 border border-gray-600"},"Abreviatura"),e("th",{class:"px-2 py-2 border border-gray-600"},"DescripciÃ³n"),e("th",{class:"px-2 py-2 border border-gray-600"},"Estado"),e("th",{class:"px-2 py-2 border border-gray-600"},"Acciones")])],-1)),e("tbody",null,[(n(!0),r(A,null,$(x.value,a=>(n(),r("tr",{key:a.id_unidad,class:i(l.darkMode?"border-b border-gray-700 hover:bg-gray-700":"border-b hover:bg-gray-50")},[e("td",Ze,d(a.nombre_unidad),1),e("td",et,d(a.abreviatura_unidad),1),e("td",tt,d(a.descripcion_unidad),1),e("td",at,[e("span",{class:i(a.estado_unidad?"text-green-400 font-semibold":"text-red-400 font-semibold")},d(a.estado_unidad?"Activo":"Inactivo"),3)]),e("td",ot,[e("button",{onClick:I=>ne(a),class:"text-blue-500 text-sm font-semibold"}," âœï¸ ",8,dt),e("button",{onClick:I=>le(a.id_unidad),class:"text-red-500 text-sm font-semibold"}," ðŸ—‘ ",8,rt)])],2))),128)),x.value.length?v("",!0):(n(),r("tr",it,[e("td",{colspan:"5",class:i(["text-center py-3",l.darkMode?"text-gray-300":"text-gray-500"])}," No hay unidades registradas ",2)]))])])])):v("",!0)])):v("",!0)],2))}},ut=ce(nt,[["__scopeId","data-v-184100ee"]]);export{ut as default};
