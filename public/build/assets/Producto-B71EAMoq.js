import{q as k,d,H as ut,A as dt,L as V,e as n,a as t,f as m,n as l,l as b,K as T,F as N,i as $,t as s,v as h,s as ct,k as z,h as F,o as u}from"./app-DZXOPLfm.js";import{_ as pt}from"./_plugin-vue_export-helper-DlAUqK2U.js";const bt={class:"flex items-end gap-4 mb-6"},vt={class:"flex-1"},gt=["value"],mt=["value"],_t={class:"flex items-center gap-2 col-span-2"},ft={class:"col-span-2"},xt={key:0,class:"mt-2 flex items-center gap-2"},yt=["src"],kt={class:"col-span-2 flex justify-end gap-2"},ht={type:"submit",class:"btn-green"},Ct={class:"col-span-2 flex justify-end gap-2"},wt={type:"submit",class:"btn-blue"},Pt={class:"overflow-x-auto"},Et={class:"px-2 py-1 text-center"},Ut={class:"px-2 py-1"},Vt={class:"px-2 py-1"},St={class:"px-2 py-1 text-center space-x-3"},Mt=["onClick"],Nt=["onClick"],$t={key:0},Ft={key:1,class:"overflow-x-auto"},Dt={class:"px-2 py-2"},Lt={class:"px-2 py-2"},jt={class:"px-2 py-2"},At={class:"px-2 py-2 text-right"},It={class:"px-2 py-2 text-right"},Rt={class:"px-2 py-2 text-center"},Tt={class:"px-2 py-2 text-center space-x-3"},zt=["onClick"],Bt=["onClick"],qt={key:0},Ot={key:0,class:"flex flex-col sm:flex-row justify-between items-center gap-3 mt-4 text-sm"},Gt={class:"flex items-center gap-2"},Ht=["disabled"],Kt=["disabled"],Qt={__name:"Producto",props:{darkMode:{type:Boolean,default:!1},fontClass:{type:String,default:"font-sans"}},setup(B){const q="https://www.tecnoweb.org.bo/inf513/grupo06cc/metaluv-camiri/public/".replace(/\/$/,""),O=a=>a?String(a).startsWith("http")?a:`${q.replace("/public","")}/storage/app/public/${a}`:null,I=B,i=k(()=>I.darkMode),G=k(()=>I.fontClass),c=d([]),w=d([]),P=d("todos"),E=d(!1),r=d({id_producto:"",nombre_prod:"",tipo_producto:"",descripcion_prod:"",precio_unitario_prod:"",stock_prod:"",prod_disponible:!0,foto_prod:"",id_categoria:"",foto:null}),_=d(!1),D=d(null),C=d(null),f=d(null),S=d(!1),v=d({id_categoria:"",cat_nombre:"",cat_descripcion:""}),x=d(!1),L=d(null),p=d(1),U=d(10),M=k(()=>c.value.length?Math.ceil(c.value.length/U.value):0),H=k(()=>{const a=(p.value-1)*U.value;return c.value.slice(a,a+U.value)}),K=k(()=>c.value.length?(p.value-1)*U.value+1:0),Q=k(()=>c.value.length?Math.min(p.value*U.value,c.value.length):0);function W(){p.value<M.value&&p.value++}function J(){p.value>1&&p.value--}ut(c,()=>{p.value=1});const g=k(()=>i.value?"bg-gray-900 border-gray-700 text-gray-100 placeholder-gray-400":"bg-white border-gray-300 text-gray-900 placeholder-gray-400");dt(()=>{y()});function X(){E.value=!E.value,E.value&&!c.value.length&&y()}function y(){const a={};P.value&&P.value!=="todos"&&(a.id_categoria=P.value),V.get("propietario/melamina/productos",{params:a}).then(e=>{c.value=e.data.productos||[],w.value=e.data.categorias||[]}).catch(e=>{console.error("Error al obtener productos:",e),alert("Error al obtener productos")})}function Y(a,e){const o=a.target.files[0];o&&(r.value.foto=o,C.value=URL.createObjectURL(o))}function Z(){r.value.foto=null,C.value=null,f.value&&(f.value.value=null)}function tt(){const a=new FormData;a.append("nombre_prod",r.value.nombre_prod),a.append("tipo_producto",r.value.tipo_producto),a.append("descripcion_prod",r.value.descripcion_prod||""),a.append("precio_unitario_prod",r.value.precio_unitario_prod||0),a.append("stock_prod",r.value.stock_prod||0),a.append("prod_disponible",r.value.prod_disponible?1:0),a.append("id_categoria",r.value.id_categoria||""),r.value.foto&&a.append("foto",r.value.foto);const e=_.value?`propietario/melamina/productos/${D.value}`:"propietario/melamina/productos";V.post(e,a,{headers:{"Content-Type":"multipart/form-data"}}).then(o=>{o.data.success&&(alert(_.value?"Producto actualizado":"Producto registrado"),R(),y())}).catch(o=>{console.error("Error al guardar producto:",o),alert("Error al guardar producto")})}function et(a){_.value=!0,D.value=a.id_producto,r.value.id_producto=a.id_producto,r.value.nombre_prod=a.nombre_prod,r.value.tipo_producto=a.tipo_producto,r.value.descripcion_prod=a.descripcion_prod,r.value.precio_unitario_prod=a.precio_unitario_prod,r.value.stock_prod=a.stock_prod,r.value.prod_disponible=!!a.prod_disponible,r.value.id_categoria=a.id_categoria,r.value.foto=null,C.value=O(a.foto_prod),f.value&&(f.value.value=null)}function ot(){_.value=!1,R()}function at(a){confirm("Â¿Eliminar este producto?")&&V.delete(`propietario/melamina/productos/${a}`).then(()=>{alert("Producto eliminado"),y()}).catch(e=>{console.error("Error al eliminar producto:",e),alert("Error al eliminar producto")})}function R(){_.value=!1,D.value=null,C.value=null,f.value&&(f.value.value=null),r.value={id_producto:"",nombre_prod:"",tipo_producto:"",descripcion_prod:"",precio_unitario_prod:"",stock_prod:"",prod_disponible:!0,foto_prod:"",id_categoria:"",foto:null}}function rt(){S.value=!S.value}function lt(){const a={cat_nombre:v.value.cat_nombre,cat_descripcion:v.value.cat_descripcion||""},e=x.value?`propietario/melamina/categorias/${L.value}`:"propietario/melamina/categorias";V.post(e,a).then(o=>{o.data.success&&(alert(x.value?"CategorÃ­a actualizada":"CategorÃ­a registrada"),j(),y())}).catch(o=>{console.error("Error al guardar categorÃ­a:",o),alert("Error al guardar categorÃ­a")})}function st(a){x.value=!0,L.value=a.id_categoria,v.value.cat_nombre=a.cat_nombre,v.value.cat_descripcion=a.cat_descripcion}function it(a){confirm("Â¿Eliminar esta categorÃ­a? (Los productos quedarÃ¡n sin categorÃ­a)")&&V.delete(`propietario/melamina/categorias/${a}`).then(()=>{alert("CategorÃ­a eliminada"),j(),y()}).catch(e=>{console.error("Error al eliminar categorÃ­a:",e),alert("Error al eliminar categorÃ­a")})}function nt(){x.value=!1,j()}function j(){x.value=!1,L.value=null,v.value={id_categoria:"",cat_nombre:"",cat_descripcion:""}}return(a,e)=>(u(),n("div",{class:l(["p-8 rounded-2xl shadow-md transition-colors duration-300",i.value?"bg-gray-800 text-gray-100":"bg-white text-gray-900",G.value])},[t("h2",{class:l(["text-2xl font-bold mb-6",i.value?"text-blue-400":"text-blue-700"])}," GestiÃ³n de Productos ",2),t("div",bt,[t("div",vt,[e[12]||(e[12]=t("label",{class:"block text-sm font-semibold mb-1"},"Filtrar por categorÃ­a",-1)),b(t("select",{"onUpdate:modelValue":e[0]||(e[0]=o=>P.value=o),class:l(["input",g.value]),onChange:y},[e[11]||(e[11]=t("option",{value:"todos"},"Todas",-1)),(u(!0),n(N,null,$(w.value,o=>(u(),n("option",{key:o.id_categoria,value:o.id_categoria},s(o.cat_nombre),9,gt))),128))],34),[[T,P.value]])]),t("button",{onClick:X,class:"btn-blue"},s(E.value?"Ocultar lista":"Listar productos"),1),t("button",{onClick:rt,class:"btn-gray"},s(S.value?"Ocultar categorÃ­as":"CategorÃ­as"),1)]),t("form",{onSubmit:z(tt,["prevent"]),class:"grid grid-cols-2 gap-4 mb-8"},[t("div",null,[e[13]||(e[13]=t("label",{class:"block text-sm font-semibold mb-1"},"Nombre",-1)),b(t("input",{"onUpdate:modelValue":e[1]||(e[1]=o=>r.value.nombre_prod=o),type:"text",class:l(["input",g.value])},null,2),[[h,r.value.nombre_prod]])]),t("div",null,[e[14]||(e[14]=t("label",{class:"block text-sm font-semibold mb-1"},"Tipo de producto",-1)),b(t("input",{"onUpdate:modelValue":e[2]||(e[2]=o=>r.value.tipo_producto=o),type:"text",class:l(["input",g.value])},null,2),[[h,r.value.tipo_producto]])]),t("div",null,[e[16]||(e[16]=t("label",{class:"block text-sm font-semibold mb-1"},"CategorÃ­a",-1)),b(t("select",{"onUpdate:modelValue":e[3]||(e[3]=o=>r.value.id_categoria=o),class:l(["input",g.value])},[e[15]||(e[15]=t("option",{disabled:"",value:""},"Seleccione categorÃ­a",-1)),(u(!0),n(N,null,$(w.value,o=>(u(),n("option",{key:o.id_categoria,value:o.id_categoria},s(o.cat_nombre),9,mt))),128))],2),[[T,r.value.id_categoria]])]),t("div",null,[e[17]||(e[17]=t("label",{class:"block text-sm font-semibold mb-1"},"Precio unitario",-1)),b(t("input",{"onUpdate:modelValue":e[4]||(e[4]=o=>r.value.precio_unitario_prod=o),type:"number",step:"0.01",class:l(["input",g.value])},null,2),[[h,r.value.precio_unitario_prod]])]),t("div",null,[e[18]||(e[18]=t("label",{class:"block text-sm font-semibold mb-1"},"Stock",-1)),b(t("input",{"onUpdate:modelValue":e[5]||(e[5]=o=>r.value.stock_prod=o),type:"number",step:"0.01",class:l(["input",g.value])},null,2),[[h,r.value.stock_prod]])]),t("div",_t,[b(t("input",{id:"disp",type:"checkbox","onUpdate:modelValue":e[6]||(e[6]=o=>r.value.prod_disponible=o),class:"h-4 w-4"},null,512),[[ct,r.value.prod_disponible]]),e[19]||(e[19]=t("label",{for:"disp",class:"text-sm font-semibold"},"Producto disponible",-1))]),t("div",ft,[e[20]||(e[20]=t("label",{class:"block text-sm font-semibold mb-1"},"DescripciÃ³n",-1)),b(t("textarea",{"onUpdate:modelValue":e[7]||(e[7]=o=>r.value.descripcion_prod=o),rows:"2",class:l(["input",g.value])},null,2),[[h,r.value.descripcion_prod]])]),t("div",null,[e[21]||(e[21]=t("label",{class:"block text-sm font-semibold mb-1"},"Foto",-1)),t("input",{type:"file",ref_key:"fotoInput",ref:f,onChange:e[8]||(e[8]=o=>Y(o)),class:l(["input",[i.value?"bg-gray-900 border-gray-700 text-gray-100 file:bg-blue-600 file:text-white":"bg-white border-gray-300 text-gray-900 file:bg-blue-600 file:text-white"]])},null,34),C.value?(u(),n("div",xt,[t("img",{src:C.value,class:l(["w-24 h-24 object-cover rounded-lg border",i.value?"border-gray-600":"border-gray-300"])},null,10,yt),t("button",{type:"button",onClick:Z,class:"text-red-500 text-sm"}," âœ– Quitar ")])):m("",!0)]),t("div",kt,[t("button",ht,s(_.value?"Actualizar producto":"Registrar producto"),1),_.value?(u(),n("button",{key:0,type:"button",onClick:ot,class:"btn-gray"}," Cancelar ")):m("",!0)])],32),S.value?(u(),n("div",{key:0,class:l(["mb-8 border rounded-xl p-4",i.value?"bg-gray-900 border-gray-700":"bg-gray-50 border-gray-200"])},[t("h3",{class:l(["font-bold text-lg mb-4",i.value?"text-blue-400":"text-blue-700"])}," CategorÃ­as ",2),t("form",{onSubmit:z(lt,["prevent"]),class:"grid grid-cols-2 gap-4 mb-4"},[t("div",null,[e[22]||(e[22]=t("label",{class:"block text-sm font-semibold mb-1"},"Nombre categorÃ­a",-1)),b(t("input",{"onUpdate:modelValue":e[9]||(e[9]=o=>v.value.cat_nombre=o),type:"text",class:l(["input",g.value])},null,2),[[h,v.value.cat_nombre]])]),t("div",null,[e[23]||(e[23]=t("label",{class:"block text-sm font-semibold mb-1"},"DescripciÃ³n",-1)),b(t("input",{"onUpdate:modelValue":e[10]||(e[10]=o=>v.value.cat_descripcion=o),type:"text",class:l(["input",g.value])},null,2),[[h,v.value.cat_descripcion]])]),t("div",Ct,[t("button",wt,s(x.value?"Actualizar categorÃ­a":"Registrar categorÃ­a"),1),x.value?(u(),n("button",{key:0,type:"button",onClick:nt,class:"btn-gray"}," Cancelar ")):m("",!0)])],32),t("div",Pt,[t("table",{class:l(["w-full rounded-lg",i.value?"border border-gray-700 bg-gray-900":"border border-gray-200 bg-white"])},[e[24]||(e[24]=t("thead",{class:"bg-blue-600 text-white"},[t("tr",null,[t("th",{class:"px-2 py-1"},"ID"),t("th",null,"Nombre"),t("th",null,"DescripciÃ³n"),t("th",null,"Acciones")])],-1)),t("tbody",null,[(u(!0),n(N,null,$(w.value,o=>(u(),n("tr",{key:o.id_categoria,class:l(["border-b",i.value?"border-gray-700 hover:bg-gray-800":"border-gray-200 hover:bg-gray-50"])},[t("td",Et,s(o.id_categoria),1),t("td",Ut,s(o.cat_nombre),1),t("td",Vt,s(o.cat_descripcion),1),t("td",St,[t("button",{onClick:A=>st(o),class:"text-blue-500 text-sm font-semibold"}," âœï¸ Editar ",8,Mt),t("button",{onClick:A=>it(o.id_categoria),class:"text-red-500 text-sm font-semibold"}," ðŸ—‘ Eliminar ",8,Nt)])],2))),128)),w.value.length?m("",!0):(u(),n("tr",$t,[t("td",{colspan:"4",class:l(["text-center py-3",i.value?"text-gray-300":"text-gray-500"])}," No hay categorÃ­as registradas ",2)]))])],2)])],2)):m("",!0),E.value?(u(),n("div",Ft,[t("table",{class:l(["w-full rounded-lg",i.value?"border border-gray-700":"border border-gray-200"])},[e[25]||(e[25]=t("thead",{class:"bg-blue-600 text-white"},[t("tr",null,[t("th",{class:"px-2 py-2 text-left"},"Nombre"),t("th",{class:"px-2 py-2 text-left"},"Tipo"),t("th",{class:"px-2 py-2 text-left"},"CategorÃ­a"),t("th",{class:"px-2 py-2 text-right"},"Precio"),t("th",{class:"px-2 py-2 text-right"},"Stock"),t("th",{class:"px-2 py-2 text-center"},"Disp."),t("th",{class:"px-2 py-2 text-center"},"Acciones")])],-1)),t("tbody",null,[(u(!0),n(N,null,$(H.value,o=>(u(),n("tr",{key:o.id_producto,class:l(["border-b",i.value?"border-gray-700 hover:bg-gray-800":"border-gray-200 hover:bg-gray-50"])},[t("td",Dt,s(o.nombre_prod),1),t("td",Lt,s(o.tipo_producto),1),t("td",jt,s(o.categoria?o.categoria.cat_nombre:""),1),t("td",At," S/ "+s(Number(o.precio_unitario_prod||0).toFixed(2)),1),t("td",It,s(o.stock_prod),1),t("td",Rt,[t("span",{class:l(["px-2 py-1 rounded-full text-xs font-semibold",o.prod_disponible?"bg-green-100 text-green-700":"bg-red-100 text-red-700"])},s(o.prod_disponible?"SÃ­":"No"),3)]),t("td",Tt,[t("button",{onClick:A=>et(o),class:"text-blue-500 text-sm font-semibold"}," âœï¸ Editar ",8,zt),t("button",{onClick:A=>at(o.id_producto),class:"text-red-500 text-sm font-semibold"}," ðŸ—‘ Eliminar ",8,Bt)])],2))),128)),c.value.length?m("",!0):(u(),n("tr",qt,[t("td",{colspan:"7",class:l(["text-center py-3",i.value?"text-gray-300":"text-gray-500"])}," No hay productos para la categorÃ­a seleccionada ",2)]))])],2),c.value.length?(u(),n("div",Ot,[t("span",{class:l(i.value?"text-gray-300":"text-gray-600")},[e[26]||(e[26]=F(" Mostrando ",-1)),t("b",null,s(K.value),1),e[27]||(e[27]=F(" - ",-1)),t("b",null,s(Q.value),1),e[28]||(e[28]=F(" de ",-1)),t("b",null,s(c.value.length),1),e[29]||(e[29]=F(" productos ",-1))],2),t("div",Gt,[t("button",{type:"button",onClick:J,disabled:p.value===1,class:l(["px-3 py-1 rounded-lg border text-xs font-semibold disabled:opacity-50 disabled:cursor-not-allowed",i.value?"border-gray-600 text-gray-100 hover:bg-gray-700":"border-gray-300 text-gray-800 hover:bg-gray-100"])}," â—€ Anterior ",10,Ht),t("span",{class:l(i.value?"text-gray-200":"text-gray-700")}," PÃ¡gina "+s(p.value)+" de "+s(M.value),3),t("button",{type:"button",onClick:W,disabled:p.value===M.value||M.value===0,class:l(["px-3 py-1 rounded-lg border text-xs font-semibold disabled:opacity-50 disabled:cursor-not-allowed",i.value?"border-gray-600 text-gray-100 hover:bg-gray-700":"border-gray-300 text-gray-800 hover:bg-gray-100"])}," Siguiente â–¶ ",10,Kt)])])):m("",!0)])):m("",!0)],2))}},Xt=pt(Qt,[["__scopeId","data-v-80dff3a6"]]);export{Xt as default};
