import{y as q,d as _,q as z,A as U,x as A,H as R,e as n,a as e,f as p,n as a,g as t,F as $,i as H,c as O,t as l,h as x,I as Z,m as G,N as C,o as r}from"./app-DZXOPLfm.js";import{b as J,m as K,a as Q,s as W}from"./moon-MbLN2chc.js";import X from"./PagosCliente-Z5HQdEe6.js";import{c as Y}from"./construction-DxInhbHk.js";import{m as ee}from"./credit-card-C9k4TCjG.js";import{i as te}from"./map-CNSC9BbO.js";import{m as oe}from"./man-Bte0AleJ.js";import{_ as ae}from"./_plugin-vue_export-helper-DlAUqK2U.js";const se={class:"flex items-center justify-between mb-4"},re={key:0,class:"text-xl font-bold text-blue-500 whitespace-nowrap"},ne=["title"],le=["src"],ie={key:0,class:"text-xs font-semibold uppercase tracking-wide"},ce=["src"],de={class:"space-y-2 mt-4"},ue=["onClick"],pe=["src","alt"],ge={key:0,class:"truncate"},me={class:"flex-1 p-6 md:p-8 transition-colors duration-300"},xe={class:"mb-6"},ye={class:"text-3xl font-bold mb-2"},be={key:0},ve={key:1,class:"space-y-4"},fe={class:"flex flex-col md:flex-row md:items-center md:justify-between gap-4"},_e={class:"text-xl font-bold"},he={key:0,class:"space-y-2"},we={class:"w-full bg-gray-200 rounded-full h-3 overflow-hidden"},ke={class:"grid grid-cols-1 sm:grid-cols-3 gap-3 mt-4"},Ce={class:"text-xl font-bold text-blue-500"},Ie={class:"text-xl font-bold text-green-500"},je={key:0},Ne={key:1,class:"space-y-4"},De={class:"font-semibold"},Ae={key:0},Me={key:1,class:"space-y-2"},Se={class:"font-semibold"},Fe={class:"font-semibold"},Le={class:"font-semibold"},Pe={class:"font-semibold"},Te={__name:"Dashboard",setup(Be){const{props:v}=q(),M=v.user||{},i=v.proyecto||null,c=v.metrics||null,y=v.propietario||null,S=v.nombreCliente||M.name||"",g=_("avance"),o=_(!1),d=_(!1);function F(){o.value=!o.value}function L(){d.value=!d.value}const P=[{view:"avance",label:"Avance de la obra",icon:Y},{view:"pagos",label:"Pagos",icon:ee},{view:"ubicacion",label:"Ubicaci贸n del proyecto",icon:te},{view:"contacto",label:"Contacto",icon:oe}];function T(m){g.value=m}function B(){G.post(W("logout"),{},{replace:!0})}const h=z(()=>["rounded-2xl shadow p-6 transition-colors duration-300",o.value?"bg-gray-800 text-gray-100":"bg-white text-gray-800"].join(" ")),w=_(null);let b=null,k=null;const f={lat:-17.8,lng:-63.2};function E(){!w.value||b||(b=C.map(w.value).setView([f.lat,f.lng],13),C.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19,attribution:"&copy; OpenStreetMap contributors"}).addTo(b),k=C.marker([f.lat,f.lng]).addTo(b))}async function I(){if(!(!i||!i.direccion_pro)&&(E(),!(!b||!k)))try{const m=`https://nominatim.openstreetmap.org/search?format=json&limit=1&q=${encodeURIComponent(i.direccion_pro)}`,u=await(await fetch(m,{headers:{"Accept-Language":"es","User-Agent":"melamina-cliente/1.0"}})).json();if(!u.length){console.warn("No se encontr贸 la direcci贸n en el mapa");return}const{lat:j,lon:V}=u[0],N=parseFloat(j),D=parseFloat(V);b.setView([N,D],17),k.setLatLng([N,D])}catch(m){console.error("Error al geocodificar direcci贸n del proyecto:",m)}}return U(()=>{g.value==="ubicacion"&&A(()=>{I()})}),R(g,m=>{m==="ubicacion"&&A(()=>{I()})}),(m,s)=>(r(),n("div",{class:a(["flex min-h-screen transition-colors duration-300",o.value?"bg-gray-900 text-gray-100":"bg-gray-100 text-gray-900"])},[e("aside",{class:a(["shadow-md p-4 flex flex-col justify-between transition-all duration-300",d.value?"w-20":"w-64",o.value?"bg-gray-800 text-gray-100":"bg-white text-gray-800"])},[e("div",null,[e("div",se,[d.value?p("",!0):(r(),n("h2",re," Panel del Cliente ")),e("button",{onClick:L,class:"p-2 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-700",title:d.value?"Expandir men煤":"Colapsar men煤"},[e("img",{src:t(J),class:a(["w-5 h-5 transition-transform",d.value?"rotate-180":""]),alt:"Colapsar men煤"},null,10,le)],8,ne)]),e("div",{class:a(["flex items-center justify-between mb-4 px-2 py-2 rounded-lg",o.value?"bg-gray-700":"bg-gray-100"])},[d.value?p("",!0):(r(),n("span",ie," Modo oscuro ")),e("button",{onClick:F,class:"flex items-center gap-2 text-sm font-medium"},[d.value?p("",!0):(r(),n("img",{key:0,src:o.value?t(K):t(Q),class:"w-5 h-5",alt:"Modo oscuro"},null,8,ce)),e("span",{class:a(["w-10 h-5 flex items-center rounded-full p-1 transition-all duration-200",o.value?"bg-blue-500":"bg-gray-300"])},[e("span",{class:a(["w-4 h-4 bg-white rounded-full shadow transform transition-transform duration-200",o.value?"translate-x-5":"translate-x-0"])},null,2)],2)])],2),e("nav",de,[(r(),n($,null,H(P,u=>e("button",{key:u.view,onClick:j=>T(u.view),class:a(["w-full flex items-center gap-2 px-3 py-2 rounded-lg font-medium text-sm transition-colors",g.value===u.view?"bg-blue-600 text-white":o.value?"text-gray-200 hover:bg-gray-700":"text-gray-700 hover:bg-blue-100"])},[e("img",{src:u.icon,class:"w-5 h-5",alt:u.label},null,8,pe),d.value?p("",!0):(r(),n("span",ge,l(u.label),1))],10,ue)),64))])]),e("div",{class:"mt-6"},[e("button",{onClick:B,class:"w-full bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg font-semibold transition"},"  Salir ")])],2),e("main",me,[e("header",xe,[e("h1",ye," Bienvenido, "+l(t(S)),1),e("p",{class:a(["text-sm md:text-base",o.value?"text-gray-300":"text-gray-600"])}," Aqu铆 puedes revisar el avance de tu obra, pagos, ubicaci贸n del proyecto y datos de contacto. ",2)]),g.value==="avance"?(r(),n("section",{key:0,class:a([h.value,"space-y-4"])},[s[4]||(s[4]=e("h2",{class:"text-2xl font-semibold text-blue-500"}," Avance de la obra ",-1)),t(i)?(r(),n("div",ve,[e("div",fe,[e("div",null,[e("h3",_e,l(t(i).nombre_pro),1),e("p",{class:a(o.value?"text-gray-300":"text-gray-600")},l(t(i).descripcion_pro||"Sin descripci贸n registrada."),3)]),e("div",{class:a(["text-sm",o.value?"text-gray-300":"text-gray-600"])},[e("p",null,[s[0]||(s[0]=e("span",{class:"font-semibold"},"Fecha inicio:",-1)),x(" "+l(t(i).fecha_inicio_pro),1)]),e("p",null,[s[1]||(s[1]=e("span",{class:"font-semibold"},"Fecha fin:",-1)),x(" "+l(t(i).fecha_fin_pro),1)]),e("p",null,[s[2]||(s[2]=e("span",{class:"font-semibold"},"Estado:",-1)),x(" "+l(t(c)?.estado||t(i).estado_proyecto),1)])],2)]),t(c)?(r(),n("div",he,[e("div",{class:a(["flex justify-between text-sm",o.value?"text-gray-300":"text-gray-600"])},[s[3]||(s[3]=e("span",null,"Progreso estimado",-1)),e("span",null,l(t(c).porcentaje)+" %",1)],2),e("div",we,[e("div",{class:a(["h-3 rounded-full transition-all",t(c).porcentaje>=100?"bg-green-500":"bg-blue-500"]),style:Z({width:t(c).porcentaje+"%"})},null,6)]),e("div",ke,[e("div",{class:a(["p-3 rounded-xl text-center",o.value?"bg-blue-900/40":"bg-blue-50"])},[e("p",{class:a(["text-xs uppercase",o.value?"text-gray-300":"text-gray-500"])}," D铆as totales ",2),e("p",Ce,l(t(c).total_dias),1)],2),e("div",{class:a(["p-3 rounded-xl text-center",o.value?"bg-green-900/40":"bg-green-50"])},[e("p",{class:a(["text-xs uppercase",o.value?"text-gray-300":"text-gray-500"])}," D铆as transcurridos ",2),e("p",Ie,l(t(c).dias_transcurridos),1)],2),e("div",{class:a(["p-3 rounded-xl text-center",t(c).dias_restantes>0?o.value?"bg-red-900/40":"bg-red-50":o.value?"bg-gray-700":"bg-gray-100"])},[e("p",{class:a(["text-xs uppercase",o.value?"text-gray-300":"text-gray-500"])}," D铆as restantes ",2),e("p",{class:a(["text-xl font-bold",t(c).dias_restantes>0?"text-red-500":o.value?"text-gray-200":"text-gray-600"])},l(t(c).dias_restantes),3)],2)]),e("p",{class:a(["text-xs",o.value?"text-gray-400":"text-gray-500"])}," C谩lculo realizado al d铆a: "+l(t(c).hoy),3)])):p("",!0)])):(r(),n("div",be,[e("p",{class:a(o.value?"text-gray-300":"text-gray-600")}," A煤n no tienes un proyecto asignado. Cuando el propietario registre tu obra, podr谩s ver aqu铆 el avance. ",2)]))],2)):p("",!0),g.value==="pagos"?(r(),O(X,{key:1,proyecto:t(i),propietario:t(y),"dark-mode":o.value},null,8,["proyecto","propietario","dark-mode"])):p("",!0),g.value==="ubicacion"?(r(),n("section",{key:2,class:a([h.value,"space-y-4"])},[s[6]||(s[6]=e("h2",{class:"text-2xl font-semibold text-blue-500"},"Ubicaci贸n del proyecto",-1)),t(i)?(r(),n("div",Ne,[e("p",{class:a(o.value?"text-gray-300":"text-gray-700")},[s[5]||(s[5]=x(" Direcci贸n registrada: ",-1)),e("span",De,l(t(i).direccion_pro||"Sin direcci贸n registrada."),1)],2),t(i).direccion_pro?(r(),n("div",{key:0,ref_key:"mapRef",ref:w,class:"w-full h-72 rounded-lg border overflow-hidden"},null,512)):(r(),n("p",{key:1,class:a(["text-sm",o.value?"text-gray-400":"text-gray-500"])}," No hay una direcci贸n v谩lida para mostrar en el mapa. ",2))])):(r(),n("div",je,[e("p",{class:a(o.value?"text-gray-300":"text-gray-600")}," A煤n no tienes un proyecto registrado, por lo tanto no hay ubicaci贸n para mostrar. ",2)]))],2)):p("",!0),g.value==="contacto"?(r(),n("section",{key:3,class:a([h.value,"space-y-3"])},[s[11]||(s[11]=e("h2",{class:"text-2xl font-semibold text-blue-500 mb-2"},"Contacto del propietario",-1)),t(y)?(r(),n("div",Me,[e("p",null,[s[7]||(s[7]=x(" Nombre: ",-1)),e("span",Se,l(t(y).nombre_propietario)+" "+l(t(y).apellido_propietario),1)]),e("p",null,[s[8]||(s[8]=x(" Correo: ",-1)),e("span",Fe,l(t(y).correo_propietario),1)]),e("p",null,[s[9]||(s[9]=x(" Tel茅fono: ",-1)),e("span",Le,l(t(y).telefono_propietario),1)]),e("p",null,[s[10]||(s[10]=x(" Direcci贸n: ",-1)),e("span",Pe,l(t(y).direccion_propietario),1)])])):(r(),n("div",Ae,[e("p",{class:a(o.value?"text-gray-300":"text-gray-600")}," No se encontr贸 informaci贸n del propietario de tu proyecto. ",2)]))],2)):p("",!0)])],2))}},Oe=ae(Te,[["__scopeId","data-v-d94cf5be"]]);export{Oe as default};
